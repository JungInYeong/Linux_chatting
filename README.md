# ë¦¬ëˆ…ìŠ¤ ì†Œì¼“ í”„ë¡œê·¸ë˜ë°
&nbsp;
&nbsp;

## â˜ï¸ í”„ë¡œì íŠ¸ ì†Œê°œ
wsl2ì•ˆì—ì„œ Ubuntuë¥¼ ì‚¬ìš©í•´, C99ë¥¼ ì´ìš©í•´ì„œ CLIê¸°ë°˜ ê°„ë‹¨í•œ ì±„íŒ…í”„ë¡œê·¸ë¨ì„ êµ¬í˜„í•´ë³¸ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤
&nbsp;
&nbsp;

## ğŸ¤” ì£¼ìš”ê¸°ëŠ¥
```sh
[client shell]
* ë¡œê·¸ì¸ê¸°ëŠ¥, íšŒì›ê°€ì…ê¸°ëŠ¥
* ì»¤ë§¨ë“œê¸°ëŠ¥ : ë©”ì¸ë©”ë‰´ ë³µê·€, í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
```
```sh
[server shell]
* ê³„ì •ì‚¬ìš© ê¸°ëŠ¥
* ì»´íŒŒì¼ ì˜µì…˜ì„ í†µí•œ DEBUGëª¨ë“œì™€ RELEASEëª¨ë“œ ë¶„ë¦¬
* ì»¤ë§¨ë“œê¸°ëŠ¥ : í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ, ê°•í‡´, í˜„ì ‘ì í™•ì¸

[ëª¨ë“œì •ë³´]
RELEASEëª¨ë“œ : MYSQL DBë¥¼ ì—°ë™í•˜ì—¬, ê³„ì •ì‚¬ìš©ê¸°ëŠ¥ì„ ì»¨íŠ¸ë¡¤ (ì‚¬ì „ì— MySQLì„ ë¦¬ëˆ…ìŠ¤ì— ê¹”ì•„ì•¼ í• ê²ƒ)
DEBUGëª¨ë“œ : .txt í˜•íƒœë¡œ DBë¥¼ ë§Œë“¤ì–´, ê³„ì •ì‚¬ìš©ê¸°ëŠ¥ì„ ì»¨íŠ¸ë¡¤
```

## â„¹ï¸ ê°œë°œì •ë³´

* ê°œë°œê¸°ê°„ : 24.07.02 ~ 07.17
* ê°œë°œì¸ì› : ë¥˜ì„±ìˆ˜(dbtjdtn325@gmail.com), ì •ì¸ì˜
* ê°œë°œí™˜ê²½ : wsl2 Ubuntu (22.04.4) , C99, MySQL (8.0.32)

## âš¡ì„¤ì¹˜ ë° ì‹¤í–‰ë°©ë²•

ë ˆí¬ì§€í† ë¦¬ë¥¼ clone í•˜ê±°ë‚˜ zip Downloadë¥¼ í†µí•´ íŒŒì¼ì„ ë°›ìŠµë‹ˆë‹¤.
```sh
https://github.com/supergravityy/Linux_chatting.git
```

### ğŸ’»í´ë¼ì´ì–¸íŠ¸

#### 1. ì €ì¥ëœ ë””ë ‰í„°ë¦¬ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ gccë¡œ íŒŒì¼ë“¤ì„ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¡œ ì»´íŒŒì¼ í•´ì¤ë‹ˆë‹¤.
   ```sh
   gcc -lpthread clnt_socket.c clnt_shell2.c clnt_commu.c -o client.out
   ```
   (í˜¹ì€ 'make'ë§Œ ì…ë ¥í•´ë„ ìƒê´€ì—†ìŠµë‹ˆë‹¤)

#### 2. client.out íŒŒì¼ì‹¤í–‰ì‹œ, ì„œë²„ì˜ IPì£¼ì†Œë„ ë„£ì–´ì¤ë‹ˆë‹¤


   ![ìŠ¤í¬ë¦°ìƒ· 2024-07-17 185557](https://github.com/user-attachments/assets/27a279ba-3566-409c-a511-d28741c6d3f7)

(ë§Œì•½, wsl2 ì•ˆì˜ ë¦¬ëˆ…ìŠ¤ë¼ë©´, ë°˜ë“œì‹œ í¬íŠ¸í¬ì›Œë”©ì‘ì—…ê³¼ ë°©í™”ë²½ì„ êº¼ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤ -> ë¡œì»¬í™˜ê²½ì—ì„œ ì‘ë™ì‹œ í•„ìš” X)

#### 3. ì„œë²„ì™€ ì—°ê²°ë˜ë©´, ë©”ì¸ë©”ë‰´ë¡œ ë“¤ì–´ê°€ ì›í•˜ëŠ” ì‘ì—…ì„ ì™„ë£Œí•˜ê³  ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ê³¼ ì±„íŒ…ì„ ì‹œì‘í•˜ì‹­ì‹œì˜¤

   ![ìŠ¤í¬ë¦°ìƒ· 2024-07-17 191222](https://github.com/user-attachments/assets/39c6b8fa-81ff-4a0b-aefb-0652953df56e)

### ğŸ—’ï¸ì„œë²„ (DEBUG ëª¨ë“œ ê¸°ì¤€)

#### 1. ì €ì¥ëœ ë””ë ‰í„°ë¦¬ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ gccë¡œ íŒŒì¼ë“¤ì„ ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¡œ ì»´íŒŒì¼ í•´ì¤ë‹ˆë‹¤
   ```sh
   gcc -lpthread serv_DB.c serv_commu2.c serv_shell2.c -DDEBUG -o server.out
   ```
   (ê·¸ëƒ¥ 'make'ë§Œ ì…ë ¥ì‹œ, releaseëª¨ë“œë¡œ ì»´íŒŒì¼ ë©ë‹ˆë‹¤ -> MySQL ì‚¬ì „ ì„¤ì¹˜ì‘ì—… í•„ìš”)

#### 2. server.out ì„ ì‹¤í–‰ì‹œì¼œì¤ë‹ˆë‹¤.

(ë§Œì•½, wsl2 ì•ˆì˜ ë¦¬ëˆ…ìŠ¤ë¼ë©´, ë°˜ë“œì‹œ í¬íŠ¸í¬ì›Œë”©ì‘ì—…ê³¼ ë°©í™”ë²½ì„ êº¼ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤ -> ë¡œì»¬í™˜ê²½ì—ì„œ ì‘ë™ì‹œ í•„ìš” X)

![ìŠ¤í¬ë¦°ìƒ· 2024-07-18 011937](https://github.com/user-attachments/assets/a7ec1a70-a413-4027-8ebc-e0f4f7e6e8b1)

### ğŸ’½ì„œë²„ (RELEASE ëª¨ë“œ ê¸°ì¤€)

#### 1. Ubuntu í™˜ê²½ MySQL ì„¤ì¹˜ ë° ì„¤ì •

##### 1) MySQL ì„¤ì¹˜
   ```sh
   $ sudo apt-get install mysql-server -y
   ```

##### 2) MySQL í¬íŠ¸ ë³€ê²½, ì™¸ë¶€ ì ‘ì†í—ˆìš© ì„¤ì •
   ```sh
   $ sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf
	Port = ìì‹ ì´ ì •í•œ í¬íŠ¸ë²ˆí˜¸
   bind-adress = 0.0.0.0
   // mysql-bind-address = 127.0.0.1 (ì™¸ë¶€ ì ‘ì†ì„ ìœ„í•´ ì£¼ì„ì²˜ë¦¬)
   ```

##### 3) MySQL ì¬ì‹œì‘.
   ```sh
   $ sudo service mysql restart
   ```

##### 4) ê¸°ì¡´í¬íŠ¸(3306) ë‹«ê¸°, ì™¸ë¶€ ì ‘ì†í¬íŠ¸ ë°©í™”ë²½ í•´ì œ
   ```sh
   $ sudo ufw deny 3306 && sudo ufw allow PORT(í¬íŠ¸ë²ˆí˜¸)
   ```

##### 5) MySQL ì‹¤í–‰ í›„, ìœ ì €ì™€ IP ì ‘ì† ê¶Œí•œ ë§Œë“¤ê¸°
   ```sh
   $ sudo mysql â€“ u root
      - USE mysql;
      - CREATE USER â€˜IDâ€™@â€™%â€™ IDENTIFIED BY MYSQL_NATIVE_PASSWORD â€˜[PW]â€™;
      - CREATE DATABASE <DBëª…>;
	   - GRANT ALL PRIVILEGES ON <DBëª…>.* to â€˜IDâ€™@â€™%â€™;
	   - FLUSH PRIVILEGES; (ë³€ê²½ì‚¬í•­ ì ìš©)
   ```

#### 2. MySQL C API ìë£Œí˜•
```sh
1) MYSQL : Database ì—°ê²°ì— ëŒ€í•œ í•¸ë“¤ëŸ¬ì…ë‹ˆë‹¤. 
2) MYSQL_RES : í–‰(SELECT, SHOW, DESCRIBE)ì„ queryì˜ ê²°ê³¼ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
3) MYSQL_ROW : í•œ í–‰ì˜ ë°ì´í„°ì— ëŒ€í•œ í˜•ì‹ì´ ì•ˆì „í•œ í‘œí˜„, ë°”ì´íŠ¸ ë¬¸ìì—´ì˜ ë°°ì—´ë¡œ êµ¬í˜„ë¨, í–‰ì€ mysql_fetch_row(MYSQL_RES *result)ë¥¼ í˜¸ì¶œí•˜ì—¬ ì–»ìŠµë‹ˆë‹¤.
4) MYSQL_FIELD : í•„ë“œì˜ ì´ë¦„, íƒ€ì…, í¬ê¸°ì— ê´€í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ìë£Œí˜•ì…ë‹ˆë‹¤.
```

#### 3. MySQL Database ì—°ê²°
```sh
1) mysql_init(MYSQL *mysql)
  - mysql_real_connect()ë¥¼ ìœ„í•˜ì—¬ MYSQL ê°ì²´ ì´ˆê¸°í™”(MYSQL ê°ì²´ë¥¼ ì´ˆê¸°í™” í•˜ë¯€ë¡œ mysq_real_connect()ì „ì— ê¼­ í˜¸ì¶œí•´ì•¼í•©ë‹ˆë‹¤.)

2) mysql_real_connect(MYSQL* mysql, const char* host, const char* user, const char* passwd, const char* db, uint port, const char* unix_socket, uint client_flag)
 - hostì— ì§€ì •ëœ ì„œë²„ë¡œ ì—°ê²°ì„ ì‹œë„í•˜ëŠ” í•¨ìˆ˜
 - mysql : MYSQL ë³€ìˆ˜ì— ëŒ€í•œ í¬ì¸í„° í˜•
 - host : ì—°ê²°í•˜ê³ ì í•˜ëŠ” ì„œë²„ì˜ IP Address í˜¹ì€ ë„ë©”ì¸ ì´ë¦„ì„ ì ì–´ì£¼ë©´ ë©ë‹ˆë‹¤. NULLë¡œ ì ì–´ì£¼ë©´ localhostë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
 - user : ì ‘ì†ì‹œì˜ ì‚¬ìš©ì ì´ë¦„ì…ë‹ˆë‹¤.. NULLì´ë©´ í˜„ì¬ loginí•œ user IDê°€ ë©ë‹ˆë‹¤.
 - passwd : userì˜ ì•”í˜¸ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.. NULLì´ë©´ ì•”í˜¸ê°€ ì—†ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
 - db : ì ‘ì†ì‹œì— ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” databaseë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. NULLë¡œ ì§€ì •ì„ í•˜ë©´ ì—°ê²° í›„ì— mysql_select_db() í˜¹ì€ mysql_query()ë¥¼ ì´ìš©í•´ì„œ ì§€ì •í•  ìˆ˜ ìˆê³ , databaseë¥¼ ë°”ê¿€ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
 - port : TCP/IP ì—°ê²°ì‹œì— ì‚¬ìš©í•  í¬íŠ¸ ë²ˆí˜¸ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
 - unix_socket : ë³´í†µ NULLë¡œ í•˜ë©´ë©ë‹ˆë‹¤.
 - client_flag : ì´ ì¸ìë„ ë³´í†µ 0ìœ¼ë¡œ í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

mysql_real_connect()ëŠ” ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ì´ ë˜ë©´, MYSQL í¬ì¸í„°ë¥¼ ë„˜ê²¨ì£¼ê³  ì—°ê²°ì— ì‹¤íŒ¨í•˜ì˜€ì„ ê²½ìš° NULLì„ ë¦¬í„´í•©ë‹ˆë‹¤.

3) mysql_close(MYSQL* mysql)
  - ì„œë²„ì™€ ì—°ê²°ì„ ëŠê³  mysqlì— í• ë‹¹ë˜ì—ˆë˜ ë©”ëª¨ë¦¬ë¥¼ í•´ì œí•©ë‹ˆë‹¤.
```

#### 4. MySQL query ë° ê²°ê³¼ê°’ ì–»ì–´ì˜¤ê¸°
```sh
1) mysql_query(MYSQL* mysql, const char* query)
  - query ì‹¤í–‰ ì‹œí‚´(mysql í´ë¼ì´ì–¸íŠ¸ì—ì„œ í–ˆë˜ ê²ƒ ì²˜ëŸ¼ queryì˜ ëì— â€˜;â€™ê°€ í¬í•¨ë˜ì–´ì„œëŠ” ì•ˆ ë¨)

 2) mysql_store_result(MYSQL* mysql)
  -  queryì˜ ê²°ê³¼ë¡œ ë¦¬í„´ë˜ëŠ” ROWë“¤ì„ í•œêº¼ë²ˆì— ì–»ì–´ì˜´

 3) mysql_fetch_row(MYSQL_ROW* result)
 - resultì— ìˆëŠ” ROWë“¤ì—ì„œ í•œ ê°œì˜ ROWë¥¼ ì–»ì–´ ì˜´
```

#### 5. MySQL C API ê°œë°œí™˜ê²½ êµ¬ì¶•
```sh
 1) ë¼ì´ë¸ŒëŸ¬ë¦¬(mysql.h) ì„¤ì¹˜
  - apt-get install libmysqlclient-dev

 2) include ë°©ë²•
 - #include <mysql/mysql.h>

 3) ì»´íŒŒì¼ ë°©ë²•
 - gcc â€“o íŒŒì¼ì´ë¦„ íŒŒì¼ì´ë¦„.c â€“lmysqlclient
```

#### 6. Ubuntuí™˜ê²½ì—ì„œ DBí™•ì¸ ë°©ë²•
##### 1) rootê¶Œí™˜ ì ‘ì†ì„ í•©ë‹ˆë‹¤.
  ![ìŠ¤í¬ë¦°ìƒ· 2024-07-28 152328](https://github.com/user-attachments/assets/de45f704-c646-42ea-86bb-bb3a61b247e1)

##### 2) DB ì¢…ë¥˜ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
  ![ìŠ¤í¬ë¦°ìƒ· 2024-07-20 233128](https://github.com/user-attachments/assets/cab0e824-67e4-49e3-a39c-df0ae9a30d90)

##### 3) ì‚¬ìš©í•  DBë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
  ![ìŠ¤í¬ë¦°ìƒ· 2024-07-20 233235](https://github.com/user-attachments/assets/756e5385-a2d2-4714-ac67-e894da8d92b9)

##### 4) Tableì„ í™•ì¸í•©ë‹ˆë‹¤.
  ![ìŠ¤í¬ë¦°ìƒ· 2024-07-20 233320](https://github.com/user-attachments/assets/53895671-1428-4078-9550-a61b65c6712b)

##### 5) Dataë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.
  ![ìŠ¤í¬ë¦°ìƒ· 2024-07-20 233419](https://github.com/user-attachments/assets/af1ef9cc-eb54-4bba-bdba-28132f15a443)
